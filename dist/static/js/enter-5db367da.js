import{E as m,d as C,r as l,a as D,o as E,as as O,b as d,c as I,e as q,f,u as y,k as b,at as v}from"./index-9c9c226d.js";const z=[{prop:"_id",label:"订单ID"},{prop:"cardName",label:"卡片名称"},{prop:"categoryName",label:"卡片类别"},{prop:"nickname",label:"卡号",slots:[{render(s,t,e){var n;return[s("span",{type:"primary",size:"small"},e.cardInfos?(n=e.cardInfos[0])==null?void 0:n.number:"-")]}}]},{prop:"nickname",label:"卡密",slots:[{render(s,t,e){var n;return[s("span",{type:"primary",size:"small"},e.cardInfos?(n=e==null?void 0:e.cardInfos[0])==null?void 0:n.pass:"-")]}}]},{prop:"facevalue",label:"面值（HK$）"},{prop:"option",label:"订单状态",width:"100px",fixed:"left",slots:[{render(s,t,e){return[s("span",{type:"primary"},e.status.code===3?"交易失败":e.status.code===2?"交易成功":"交易处理中")]}}]},{prop:"option",label:"操作",width:"200px",fixed:"right",slots:[{render(s,t,e){return[s(m,{type:"primary",text:"交易成功",size:"small",style:`display: ${e.status===1?"inline-block":"none"}`,onClick(){t.emit("onSuccess",e)}},"交易成功")]}},{render(s,t,e){return[s(m,{type:"danger",text:"交易失败",size:"small",style:`display: ${e.status===1?"inline-block":"none"}`,onClick(){t.emit("onError",e)}},"交易失败")]}}]}],B=[{name:"订单状态",key:"status",type:"select",showLabel:!0,options:[{value:"0",label:"全部"},{value:"1",label:"正在处理"},{value:"2",label:"交易成功"},{value:"3",label:"交易失败"}]}],F={class:"bs"},N=C({__name:"enter",setup(s){const t=l({page:1,limit:10}),e=z,n=B,c=l([]),p=l(0),i=l({status:0}),_=D({});E(()=>{o()});const o=async()=>{c.value=[];const{data:a}=await O(Object.assign(i.value,{current:t.value.page,pageSize:t.value.limit}));c.value=a.list,p.value=a.totalCount},g=a=>{t.value=a,o()};function u(a){i.value=JSON.stringify(a)==="{}"?{}:a,o()}const h=a=>{b.confirm("确认交易成功吗？",{type:"success"}).then(async()=>{const r={id:a._id,type:{status:2}};await v(r),o()}).catch(r=>{})},S=a=>{b.confirm("确认交易失败吗？",{type:"warning"}).then(async()=>{const r={id:a._id,type:{status:3}};await v(r),o()}).catch(r=>{})};return(a,r)=>{const k=d("SrmFilter"),x=d("SrmTable");return I(),q("div",F,[f(k,{items:y(n),"search-params":_,onSearch:u,onReset:u},null,8,["items","search-params"]),f(x,{columns:y(e),sourceData:c.value,reqData:i.value,pageRequest:t.value,listTotal:p.value,onOnSuccess:h,onOnError:S,onCurrentChange:g},null,8,["columns","sourceData","reqData","pageRequest","listTotal"])])}}});export{N as default};
